version: 1.0.{build}
install:
- dotnet restore
#- npm install -g bower

build:
  verbosity: minimal
  
#after_build:
#- dotnet publish src\CoreWebApplication1 --output %appveyor_build_folder%\dist

test_script:
- cd src\CoreWebApplication1 # dotnet run should be started in project folder
- ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
- ps: Start-Process dotnet -ArgumentList "run --server.urls http://0.0.0.0:5001"
- cd %APPVEYOR_BUILD_FOLDER% # come back to solution folder
- ps: Invoke-WebRequest -Uri http://localhost:5001

#artifacts:
#- path: dist
#  name: dist
#deploy:
#- provider: WebDeploy
#  server: https://ilyaf.scm.azurewebsites.net/msdeploy.axd?site=ilyaf
#  website: ilyaf
#  username: $ilyaf
#  password:
#    secure: tA6+Xicg1ODbSh8ZHVDfwexonH7ZAWOrSNXrtCMD2Dd9CCK0KMCIAqfz3vTAQ4FwVjJscJf1D2G8W+PTVpfdSA==
#  artifact: dist
#  aspnet_core: true
#  aspnet_core_force_restart: true
